# ------------------------------
# 1) Prefix: Alt + a
# ------------------------------
unbind C-b
set -g prefix M-a
bind M-a send-prefix

# ------------------------------
# 2) Status bar (tabs only; blended background)
# ------------------------------
set -g status on
set -g status-bg colour0          # your chosen dark background
set -g status-fg white
set -g status-left ""
set -g status-right ""
set -g status-interval 5
set -g status-justify left
set -g window-status-separator " "

# Inactive tabs (windows)
set -g window-status-style bg=colour238,fg=white
set -g window-status-format " #I:#W "

# Active tab (current window) — white + bold
set -g window-status-current-style bg=colour34,fg=white,bold
# Add a red 'Z' when zoomed (Prefix+z)
set -g window-status-current-format " #I:#W#{?window_zoomed_flag, #[fg=red]Z#[default],} "

# Activity hint on background tabs
set -g window-status-activity-style underscore

# Pane borders: normal vs active
set -g pane-border-style fg=colour238
set -g pane-active-border-style fg=colour34

# Display pane numbers (Prefix+q) colors
set -g display-panes-colour colour240
set -g display-panes-active-colour colour34

# ------------------------------
# 3) Mouse
# ------------------------------
set -g mouse on
setw -g mode-keys vi

# ------------------------------
# 4) True color & terminal overrides
# ------------------------------
set -g default-terminal "tmux-256color"
set -as terminal-overrides ',xterm-256color:Tc'

# ------------------------------
# 5) Navigation & splits
# ------------------------------
# Vim-like pane navigation
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Splits: | and - (and 's' for horizontal)
bind | split-window -h
bind - split-window -v
unbind s
bind s split-window -h
unbind '"'
unbind %

# ------------------------------
# 6) Mouse selection → system clipboard (Wayland/X11)
# ------------------------------
# Ensure tmux server inherits GUI env (needed for wl-copy/xclip)
set -g update-environment "DISPLAY WAYLAND_DISPLAY XDG_SESSION_TYPE XDG_RUNTIME_DIR DBUS_SESSION_BUS_ADDRESS SSH_ASKPASS SSH_AUTH_SOCK"

# Scroll wheel: enter copy-mode on first scroll; pass motion if already in mode
bind -T root WheelUpPane   if -F "#{pane_in_mode}" "send-keys -M" "copy-mode -e"
bind -T root WheelDownPane if -F "#{pane_in_mode}" "send-keys -M" "send-keys -M"

# Drag to start selection; on release copy to system clipboard
bind -T copy-mode-vi MouseDrag1Pane    send -X begin-selection
bind -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe-and-cancel "sh -lc '
  if command -v wl-copy >/dev/null 2>&1 && [ -n \"\$WAYLAND_DISPLAY\" ]; then
    wl-copy
  elif command -v xclip >/dev/null 2>&1; then
    xclip -selection clipboard -in
  else
    cat >/dev/null
  fi
'"

# Wheel navigation inside copy-mode
bind -T copy-mode-vi WheelUpPane   send -X halfpage-up
bind -T copy-mode-vi WheelDownPane send -X halfpage-down

# Enter to copy (keyboard alternative)
bind -T copy-mode-vi Enter send -X copy-pipe-and-cancel "sh -lc '
  if command -v wl-copy >/dev/null 2>&1 && [ -n \"\$WAYLAND_DISPLAY\" ]; then
    wl-copy
  elif command -v xclip >/dev/null 2>&1; then
    xclip -selection clipboard -in
  else
    cat >/dev/null
  fi
'"

# ------------------------------
# 7) Quick reload
# ------------------------------
bind r source-file ~/.tmux.conf \; display "Reloaded ~/.tmux.conf"
